# 非機能要件

## 1. 品質特性（ISO/IEC 25010 の観点）
- **機能適合性**: 投稿→審査→公開、一貫したワークフローとロール（viewer/editor/reviewer/admin）。
- **性能効率**: 地図初回表示 < 2.5s、一覧クエリ < 300ms（p95, 試験データ1万件想定）。
- **互換性**: モバイル/タブレット/PC、最新2世代の主要ブラウザ。
- **使用性**: 初学者でも 1時間でセットアップ可能な README、フォームの入力支援（必須項目・プレビュー）。
- **信頼性**: DB バックアップ毎日、RPO ≤ 24h、RTO ≤ 4h（学習用途）。
- **セキュリティ**: RLS（Supabase）で行レベル権限、OWASP ASVS L1 準拠を目標。WAF/CSP/Rate Limit。
- **保守性**: TypeScript + ESLint + Prettier、層分離（UI/Domain/Infra）、小さなPR単位。
- **移植性**: Dockerfile を用意、SQLite→PostgreSQL移行を Prisma で吸収。

## 2. セキュリティ・倫理・プライバシー
- **差別・偏見防止**: 歴史的差別に関わる地名×地図の**直接紐付け禁止**。学術的解説に留める。
- **プライバシー**: 具体住所・個人情報は**削除/丸め**、座標は **±100〜300m** ぼかし。
- **誤情報対策**: 出典必須、真偽不明は公開しない。通報→48h以内に一次対応（学習時の目標）。
- **監査**: 重要操作は audits に記録、変更履歴を保持。
- **CSP/ヘッダ**: `default-src 'self'; img-src 'self' https: data:; script-src 'self' 'unsafe-inline' https://maps.googleapis.com;` 等。
- **入力検証**: Zod でバリデーション、画像は拡張子・MIME/サイズ制限。

## 3. 観測性・ログ
- **メトリクス**: PV/滞在時間/検索数/通報数、審査所要時間。
- **ログ**: APIアクセス、失敗時スタックトレース、PIIは**ログに残さない**。
- **可視化**: Supabase/Logflare など簡易でOK。

## 4. 運用基準（SLO 例）
- **可用性**: 99.5%（学習・展示用のため過剰目標にしない）
- **性能**: p95 応答 < 500ms（API）、地図初期ロード < 2.5s
- **セキュリティ**: 重大脆弱性に7日以内対応

## 5. アクセシビリティ
- **WCAG 2.1 AA** を参考：キーボード操作、代替テキスト、コントラスト比。
- アイコンは**意味ラベル**も付与（例: `aria-label="鬼の伝説"`）。

## 6. バックアップ/リカバリ
- Supabase 自動バックアップ + 月1回エクスポート（.sql）
- 重要メディアはストレージに冗長化、公開用はサムネイル生成

## 7. 国際化/地域化（将来）
- i18n フレームワークを導入可能な構成（Next.js App Router + next-intl）。